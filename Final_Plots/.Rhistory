library(tidyverse)
library(vcfR)
library(viridis)
my_vcf <- read.vcfR("myvcf1234.vcf")
vcf_dat <- vcfR2tidy(my_vcf, single_frame = TRUE)$dat
vcf_dat <- vcf_dat %>%
mutate(gt_GT = ifelse(is.na(gt_GT), "./.", gt_GT)) %>%
separate(gt_GT, into = c("gt1", "gt2")) %>%
mutate(gt1 = ifelse(is.na(gt_GT_alleles), ".", gt1))%>%
mutate(gt2 = ifelse(is.na(gt_GT_alleles), ".", gt2)) %>%
rowwise() %>%
mutate(gt_GT = paste(sort(c(gt1,gt2)), collapse = "/"))
pal <- viridis(11, option = "D")
pal[1] <- "grey75"
# Load necessary libraries
library(patchwork)
# Source the R scripts that generate the plots
source("1e-9_Distribution.R")     # This should generate plot_a and plot_b
source("Missing_Genotype_Plot.R") # This should generate plot_c
source("Missing_Site_Plot.R")     # This should generate plot_d
# Combine the plots in the specified order
# Assuming plot_a and plot_b are created in the first script
combined_plot <- (plot_a | plot_b) / (plot_c | plot_d)
# Display the combined plot
print(combined_plot)
ggsave("~/VCFSIMPAPER/VCFSim_Tests/Final_VCFSim_Test_Data/Final_Plots/Figure_1.png", plot = combined_plot,
width = 20 * 300, height = 16 * 300, units = "px", dpi = 300)
